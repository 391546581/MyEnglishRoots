# 个人词根关联学习平台 (Project: RootFlow) 开发计划

## 1. 项目目标
构建一个**“词根驱动”**的英语单词学习工具，核心解决两个痛点：
1.  **关联记忆**：通过词根（如 `ped`）挖掘出关联的高级词汇（如 `impede`, `expedition`），而非死记硬背。
2.  **高效复习**：引入“熟悉度”管理，自动过滤已掌握单词，将精力集中在生词上。
3.  **顶级视觉**：利用 LanGeek（或其他优质词典）作为内容展示层，确保查词体验愉悦。

## 2. 系统架构设计 (Architecture)

为了满足您“拆分管理逻辑与展示逻辑”的需求，我们将采用**模块化分层架构**。

### 2.1 核心模块划分

*   **核心域 (Core Domain / The Brain)**
    *   负责数据的存储、查询和逻辑判断。
    *   **词源服务 (Etymology Service)**: 管理 `Root <-> Word` 的多对多关系。数据源来自开源项目。
    *   **词根注册表 (Root Registry)**: **[新增]** 管理词根本身的元数据（含义、来源）及用户对词根的“熟悉度”。
    *   **用户状态服务 (User State Service)**: 管理单词熟悉度（`New`, `Learning`, `Mastered`）及词根熟悉度。
    *   **深度分析记录 (Analysis Log)**: **[新增]** 存储用户对特定单词的深度笔记、助记、辨析记录。
    *   **推荐引擎 (Recommendation Engine)**: 基于词根 + 熟悉度 + 词根掌握率生成推荐学习路径。

*   **适配器层 (Adapter Layer / The Face)**
    *   负责将核心数据展示给用户，支持对接不同平台。
    *   **展示适配器 (Display Adapter)**: 目前实现 `LanGeekAdapter`（内嵌/跳转），未来可扩展 `CambridgeAdapter`, `YoudaoAdapter`。

### 2.2 技术栈选型
*   **前端框架**: **Next.js** (即使是本地运行，Next.js 也能提供最好的组件化和路由体验，方便未来扩展为 Web App)。
*   **样式方案**: **Vanilla CSS** (配合 CSS Variables 实现现代极简风格，保证灵活性)。
*   **数据库**: **SQLite** (轻量级，无需配置服务器，文件即数据库) + **Prisma** (ORM，方便管理数据结构)。
*   **数据源**: `etymonline-data` (JSON) 或 `etymology-db`。

---

## 3. 功能模块详述

### 3.1 熟悉度状态机
为每个单词设计三种状态：
*   🔴 **New (生词)**: 默认状态，搜索词根时优先展示。
*   🟡 **Learning (模糊)**: 见过但没记住，需要高频复习。
*   🟢 **Mastered (已熟)**: 已掌握，搜索结果中默认折叠或沉底，不再占用注意力。

### 3.2 词根推荐仪表盘 (Root Discovery Dashboard) **[新增]**
这是一个“入口级”功能，解决“不知道搜什么”的问题。
*   **列表展示**: 罗列常用词根（如 `ped`, `spect`, `duct`），且按掌握率排序。
*   **数据透视**:
    *   词根含义: `foot` (脚)
    *   词根熟悉度: 用户标记是否认识该词根。
    *   家族统计: 显示该词根下 `已掌握/总单词数` (e.g., "Spect: 5熟 / 12总")。
*   **推荐逻辑**: 优先通过算法推荐“高价值词根”（即：你认识其中几个简单词，但还有大量高级词未解锁的词根）。

### 3.3 深度分析与研习 (Deep Analysis & Study Log) **[新增]**
针对“需要进一步分析”的需求，设计**“研习模式”**：
*   **笔记与助记 (Personal Notes)**: 支持 Markdown 输入，记录“我为什么总记错”、“它的反义词是哪个”。
*   **辨析 (Confusion Pairs)**: 手动关联易混词（如 `adapt` vs `adopt`），系统在复习时会成对出现。
*   **AI 辅助分析**: 嵌入一个 AI 对话框，针对当前单词提问（“im-前缀在这里是‘进入’还是‘否定’？”），并将精彩回答一键保存到笔记。

### 3.4 界面交互设计
*   **搜索区**: 极简输入框，输入 `ped`。
*   **结果区 (卡片流)**:
    *   每张卡片代表一个单词。
    *   卡片左侧：单词 + 简明释义（本地数据）。
    *   卡片右侧/展开：**LanGeek 视图** (Iframe 嵌入或 "View in LanGeek" 按钮)。
    *   卡片操作：熟悉度切换按钮 (🔴/🟡/🟢)。

    

---

## 4. 开发路线图 (Roadmap)

### 阶段一：数据基建 (Data Foundation)
1.  **初始化项目**: 搭建 Next.js + Prisma + SQLite 环境。
2.  **数据导入**: 
    *   解析开源词源数据，建立 `Root`, `Word` 基础表。
    *   **[新增]** 建立 `AnalysisNote` 表，用于存储用户的笔记和分析。
3.  **API 开发**: 实现搜索、推荐列表、笔记增删改查 API。

### 阶段二：词根与状态核心 (Root & State Core)
1.  **状态机**: 实现单词熟悉度 (`WordStatus`) 和词根熟悉度 (`RootStatus`)。
2.  **推荐算法**: 实现“词根推荐列表”逻辑（按掌握率排序）。
3.  **仪表盘**: 开发首页 Dashboard，展示词根列表和整体进度。

### 阶段三：前端与分析器 (UI & Analyzer)
1.  **卡片组件**: 开发高颜值的单词卡片 + LanGeek 内嵌。
2.  **分析浮层**: 
    *   点击单词进入“详情/分析模式”。
    *   实现笔记编辑器（Markdown）和“保存分析”功能。
3.  **交互串联**: 搜索/推荐 -> 列表 -> 快速标记 -> 深度分析。

### 阶段四：润色与交付 (Polish)
1.  **助记增强**: (可选) 接入 LLM API 为生词生成“一句话助记”。
2.  **本地部署**: 编写启动脚本，确保您在本地电脑上一键运行。

---

## 5. 立即执行计划 (Next Steps)
我将按照以下顺序开始编码工作：
1.  **环境准备**：初始化 Next.js 项目。
2.  **数据获取**：帮您下载并处理一个精简版的词根数据库（先用少量数据跑通流程）。
3.  **原型开发**：实现最核心的“搜词根 -> 出列表 -> 标熟练度”功能。

您是否同意这个计划？如果没问题，我将开始初始化项目环境。
